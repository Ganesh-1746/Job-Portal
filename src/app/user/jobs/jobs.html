<div class="p-4 md:p-8 bg-[#f2e9e4ff] min-h-screen">

  <div *ngIf="selectedJob(); else jobList" class="relative">
    <div class="flex flex-wrap justify-between items-center mb-6 gap-4">
      <h2 class="text-2xl md:text-4xl font-bold text-[#22223bff]">Job Details</h2>
      <button (click)="goBackToList()"
              class="bg-gray-300 text-black px-4 py-2 rounded hover:bg-gray-400">
        Back
      </button>
    </div>

    <div class="bg-white p-4 md:p-8 rounded-xl shadow-2xl border border-gray-300">
      <h3 class="text-xl md:text-3xl font-semibold text-[#22223bff] mb-4">
        {{ selectedJob()?.title }}
      </h3>

      <div class="space-y-2 mb-6 text-gray-700 text-sm md:text-lg">
        <div class="flex items-center gap-2">
          <span class="material-icons text-blue-600">location_on</span>
          Location: {{ selectedJob()?.location }}
        </div>
        <div class="flex items-center gap-2">
          <span class="material-icons text-green-600">work</span>
          Job Type: {{ selectedJob()?.jobType }}
        </div>
        <div class="flex items-center gap-2">
          <span class="material-icons text-orange-500">access_time</span>
          Experience: {{ selectedJob()?.experience }} years
        </div>
        <div class="flex items-center gap-2">
          <span class="material-icons text-purple-600">business</span>
          Department: {{ selectedJob()?.department }}
        </div>
        <div class="flex items-center gap-2">
          <span class="material-icons text-yellow-600">payments</span>
          Salary: ₹{{ selectedJob()?.salary }}
        </div>
        <div class="flex items-center gap-2">
          <span class="material-icons text-pink-600">calendar_today</span>
          Posted on: {{ selectedJob()?.postedDate | date:'longDate' }}
        </div>
      </div>

      <div class="text-xl text-black font-medium mb-4">
        Company: <span class="font-medium">{{ selectedJob()?.companyName }}</span>
      </div>

      <div class="text-sm md:text-base text-gray-700 mb-6">
        <p><strong>Job Description:</strong><br />
          {{ selectedJob()?.description || 'Lorem ipsum...' }}
        </p>
      </div>

      <ng-container *ngIf="selectedJob() as job">
        <button *ngIf="!isAlreadyApplied(job.id); else appliedTemplate"
          (click)="applyToJob(job)"
          class="bg-[#22223bff] hover:bg-[#4a4e69ff] text-white px-6 py-2 rounded-full transition">
          Apply
        </button>
        <ng-template #appliedTemplate>
          <button disabled class="bg-gray-400 text-white px-6 py-2 rounded-full cursor-not-allowed">
            ✅ Applied
          </button>
        </ng-template>
      </ng-container>
    </div>
  </div>

  <ng-template #jobList>
    <header class="flex justify-center items-center mb-6">
      <h2 class="text-2xl md:text-4xl font-bold text-[#22223bff]">Job Search</h2>
    </header>

    <div class="mb-6 flex flex-col md:flex-row gap-3">
      <input [(ngModel)]="searchTerm"(input)="filterJobs()"
             placeholder="Search Job title or Location or Department"
             class="p-3 text-white bg-[#22223bff] border border-gray-300 rounded w-full md:flex-1 focus:outline-none"/>
      <button 
              class="bg-[#22223bff] text-white text-base px-6 py-2 rounded hover:bg-[#4a4e69ff] transition">
        Search
      </button>
    </div>

    <div *ngIf="filteredJobs().length > 0; else noJobs">
      <h3 class="text-xl md:text-3xl font-bold text-[#22223bff] mb-4">Search Results:</h3>
      <div class="grid gap-6 sm:grid-cols-1 md:grid-cols-2">
        <ng-container *ngFor="let job of filteredJobs()">
          <div class="p-4 bg-white rounded-xl shadow-md border border-gray-200 hover:shadow-xl transition-transform transform hover:-translate-y-1 duration-300">
            <h4 class="text-xl md:text-2xl font-semibold text-[#22223bff] mb-2">{{ job.title }}</h4>
            <div class="space-y-1 text-sm md:text-lg text-gray-700">
              <div class="flex items-center gap-2">
                <span class="material-icons text-blue-600">location_on</span>
                {{ job.location }}
              </div>
              <div class="flex items-center gap-2">
                <span class="material-icons text-green-600">work</span>
                {{ job.jobType }}
              </div>
              <div class="flex items-center gap-2">
                <span class="material-icons text-orange-500">access_time</span>
                {{ job.experience }} years experience
              </div>
            </div>
            <div class="mt-3 text-gray-600 text-sm md:text-base">
              Company: <span class="font-medium">{{ job.companyName }}</span>
            </div>
            <button (click)="viewJobDetails(job)"
              class="mt-4 bg-[#22223bff] text-white px-5 py-2 rounded hover:bg-[#4a4e69ff] transition">
              View Details
            </button>
          </div>
        </ng-container>
      </div>
    </div>

    <ng-template #noJobs>
      <p class="text-center text-gray-500">No jobs found matching your search.</p>
    </ng-template>

    <ng-template #allJobs>
      <h3 class="text-xl md:text-3xl font-bold text-[#22223bff] mb-4">All Jobs:</h3>
      <div class="grid gap-6 sm:grid-cols-1 md:grid-cols-2">
        <ng-container *ngFor="let job of jobs()">
          <div class="p-4 bg-white rounded-xl shadow-md border border-gray-200 hover:shadow-xl transition-transform transform hover:-translate-y-1 duration-300">
            <h4 class="text-xl md:text-2xl font-semibold text-[#22223bff] mb-2">{{ job.title }}</h4>
            <div class="space-y-1 text-sm md:text-lg text-gray-700">
              <div class="flex items-center gap-2">
                <span class="material-icons text-blue-600">location_on</span>
                {{ job.location }}
              </div>
              <div class="flex items-center gap-2">
                <span class="material-icons text-green-600">work</span>
                {{ job.jobType }}
              </div>
              <div class="flex items-center gap-2">
                <span class="material-icons text-orange-500">access_time</span>
                {{ job.experience }} years experience
              </div>
            </div>
            <div class="mt-3 text-gray-600 text-sm md:text-base">
              Company: <span class="font-medium">{{ job.companyName }}</span>
            </div>
            <button (click)="viewJobDetails(job)"
              class="mt-4 bg-[#22223bff] text-white px-5 py-2 rounded hover:bg-[#4a4e69ff] transition">
              View Details
            </button>
          </div>
        </ng-container>
      </div>
    </ng-template>
  </ng-template>
</div>
